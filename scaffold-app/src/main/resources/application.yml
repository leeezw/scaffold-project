server:
  port: 8080
  servlet:
    context-path: /
    encoding:
      charset: UTF-8
      enabled: true
      force: true

spring:
  application:
    name: scaffold-project
  
  # 数据源配置（使用 Druid）
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://129.211.62.23:3306/scaffold_db?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: scaffold_db
    password: rCan2xNrYwz7cdkM
    
    # Druid 连接池配置
    druid:
      initial-size: 5                    # 初始连接数
      min-idle: 5                         # 最小空闲连接数
      max-active: 20                      # 最大活跃连接数
      max-wait: 60000                     # 获取连接等待超时时间（毫秒）
      time-between-eviction-runs-millis: 60000  # 间隔多久进行一次检测
      min-evictable-idle-time-millis: 300000     # 连接在池中最小生存时间
      validation-query: SELECT 1          # 用来检测连接是否有效的sql
      test-while-idle: true               # 建议配置为true
      test-on-borrow: false               # 申请连接时执行validationQuery检测
      test-on-return: false               # 归还连接时执行validationQuery检测
      
      # 监控统计
      filters: stat,wall
      web-stat-filter:
        enabled: true
        url-pattern: /*
        exclusions: "*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*"
      stat-view-servlet:
        enabled: true
        url-pattern: /druid/*
        login-username: admin
        login-password: admin
        allow: 127.0.0.1
        reset-enable: false
  
  # Redis 配置
  redis:
    host: 129.211.62.23
    port: 6379
    database: 0
    password: 123456             # Redis 密码，如果没有密码可以不配置
    timeout: 5000               # 连接超时时间（毫秒）
    lettuce:
      pool:
        max-active: 8           # 连接池最大连接数
        max-idle: 8            # 连接池最大空闲连接数
        min-idle: 0            # 连接池最小空闲连接数
        max-wait: -1           # 连接池最大阻塞等待时间（负值表示没有限制）

# MyBatis 配置
mybatis:
  # MyBatis 配置文件位置
  config-location: classpath:mybatis-config.xml
  # Mapper XML 文件位置
  mapper-locations: classpath*:mapper/**/*.xml
  # 实体类包路径（别名）
  type-aliases-package: com.kite.usercenter.entity,com.kite.organization.entity

# Springdoc OpenAPI (Swagger) 配置
springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
  group-configs:
    - group: 'default'
      display-name: '默认接口组'
      paths-to-match: '/**'
      packages-to-scan: com.kite.usercenter.controller,com.kite.organization.controller

# Knife4j 配置
knife4j:
  enable: true              # 是否启用 Knife4j
  production: false         # 是否生产环境（生产环境会隐藏文档）
  setting:
    language: zh_cn         # 语言设置

# 租户/认证配置
kite:
  tenant:
    enabled: true
    header: X-Tenant-Id
    param: tenantId
    required: true
    ignore-uris:
      - /api/auth/login
      - /api/auth/current
      - /api/auth/logout
      - /api/tenants/options
      - /api/tenants/my-options
      - /v3/api-docs/**
      - /doc.html
      - /swagger-ui.html
      - /swagger-ui/**
      - /druid/**
  auth:
    enabled: true                    # 是否启用认证
    token-header: Authorization      # Token Header 名称
    token-prefix: Bearer             # Token 前缀
    secret: kite-scaffold-secret-key-2024-spring-boot-authenticator  # JWT 密钥（请修改为安全的密钥）
    expire-time: 604800000           # Token 过期时间（毫秒），默认 7 天
    mock-enabled: false              # 是否启用 Mock 用户（开发环境使用）
    mock-user-id: 1                  # Mock 用户ID
    mock-username: mock-user         # Mock 用户名
    check-permission: true           # 是否验证权限
    exclude-paths:                   # 排除路径（不需要认证的路径）
      - /api/hello
      - /api/auth/login
      - /api/auth/register
      - /doc.html                    # Knife4j 文档首页
      - /swagger-ui.html             # Swagger UI 首页
      - /swagger-ui/**               # Swagger UI 静态资源
      - /v3/api-docs                 # OpenAPI JSON 文档
      - /v3/api-docs/**              # OpenAPI JSON 文档（所有版本）
      - /webjars/**                  # Swagger/Knife4j 静态资源（JS/CSS）
      - /druid/**                    # Druid 监控页面
    session:                          # Session 配置
      enabled: true                   # 是否启用 Session 管理（默认：true）
      validate-device: true           # 是否验证设备（默认：true）
      validate-status: true            # 是否验证用户状态（默认：true）
      renewal: true                   # 是否启用 Session 续期（默认：true）
      timeout: 1800000               # Session 超时时间（毫秒，默认：30分钟）
      renewal-interval: 604800000     # Session 续期间隔（毫秒，默认：7天）

# 日志配置
logging:
  level:
    root: INFO
    com.kite: DEBUG
    org.springframework: INFO
    org.mybatis: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{50} - %msg%n"
